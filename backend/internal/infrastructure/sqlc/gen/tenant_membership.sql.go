// Code generated by sqlc. DO NOT EDIT.
// versions:
//   sqlc v1.29.0
// source: tenant_membership.sql

package gen

import (
	"context"

	"github.com/google/uuid"
)

const createTenantMembership = `-- name: CreateTenantMembership :one
INSERT INTO tenant_memberships(
    id,
    tenant_id,
    user_id,
    role,
    created_at
)
VALUES(
    $1,
    $2,
    $3,
    $4,
    CURRENT_TIMESTAMP
)
RETURNING tenant_memberships.id, tenant_memberships.tenant_id, tenant_memberships.user_id, tenant_memberships.role, tenant_memberships.created_at, tenant_memberships.left_at
`

type CreateTenantMembershipParams struct {
	ID       uuid.UUID
	TenantID uuid.UUID
	UserID   uuid.UUID
	Role     string
}

type CreateTenantMembershipRow struct {
	TenantMembership TenantMembership
}

func (q *Queries) CreateTenantMembership(ctx context.Context, arg CreateTenantMembershipParams) (CreateTenantMembershipRow, error) {
	row := q.db.QueryRow(ctx, createTenantMembership,
		arg.ID,
		arg.TenantID,
		arg.UserID,
		arg.Role,
	)
	var i CreateTenantMembershipRow
	err := row.Scan(
		&i.TenantMembership.ID,
		&i.TenantMembership.TenantID,
		&i.TenantMembership.UserID,
		&i.TenantMembership.Role,
		&i.TenantMembership.CreatedAt,
		&i.TenantMembership.LeftAt,
	)
	return i, err
}

const getTenantMembershipByTenantAndUser = `-- name: GetTenantMembershipByTenantAndUser :one
SELECT tenant_memberships.id, tenant_memberships.tenant_id, tenant_memberships.user_id, tenant_memberships.role, tenant_memberships.created_at, tenant_memberships.left_at
FROM tenant_memberships
WHERE tenant_id = $1 AND user_id = $2
`

type GetTenantMembershipByTenantAndUserParams struct {
	TenantID uuid.UUID
	UserID   uuid.UUID
}

type GetTenantMembershipByTenantAndUserRow struct {
	TenantMembership TenantMembership
}

func (q *Queries) GetTenantMembershipByTenantAndUser(ctx context.Context, arg GetTenantMembershipByTenantAndUserParams) (GetTenantMembershipByTenantAndUserRow, error) {
	row := q.db.QueryRow(ctx, getTenantMembershipByTenantAndUser, arg.TenantID, arg.UserID)
	var i GetTenantMembershipByTenantAndUserRow
	err := row.Scan(
		&i.TenantMembership.ID,
		&i.TenantMembership.TenantID,
		&i.TenantMembership.UserID,
		&i.TenantMembership.Role,
		&i.TenantMembership.CreatedAt,
		&i.TenantMembership.LeftAt,
	)
	return i, err
}

const incrementJoinCodeUsedCount = `-- name: IncrementJoinCodeUsedCount :exec
UPDATE tenant_join_codes
SET used_count = used_count + 1
WHERE code = $1
`

func (q *Queries) IncrementJoinCodeUsedCount(ctx context.Context, code string) error {
	_, err := q.db.Exec(ctx, incrementJoinCodeUsedCount, code)
	return err
}
