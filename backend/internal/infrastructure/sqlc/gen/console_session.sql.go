// Code generated by sqlc. DO NOT EDIT.
// versions:
//   sqlc v1.29.0
// source: console_session.sql

package gen

import (
	"context"

	"github.com/google/uuid"
)

const cleanupExpiredConsoleSessions = `-- name: CleanupExpiredConsoleSessions :exec
DELETE FROM console_sessions
WHERE expires_at < NOW()
`

func (q *Queries) CleanupExpiredConsoleSessions(ctx context.Context) error {
	_, err := q.db.Exec(ctx, cleanupExpiredConsoleSessions)
	return err
}

const createConsoleSession = `-- name: CreateConsoleSession :one
INSERT INTO console_sessions (
    session_id,
    organization_id,
    created_at,
    expires_at
) VALUES (
    $1, $2, NOW(), NOW() + INTERVAL '24 hours'
) RETURNING session_id, organization_id, created_at, expires_at
`

type CreateConsoleSessionParams struct {
	SessionID      string
	OrganizationID uuid.UUID
}

func (q *Queries) CreateConsoleSession(ctx context.Context, arg CreateConsoleSessionParams) (ConsoleSession, error) {
	row := q.db.QueryRow(ctx, createConsoleSession, arg.SessionID, arg.OrganizationID)
	var i ConsoleSession
	err := row.Scan(
		&i.SessionID,
		&i.OrganizationID,
		&i.CreatedAt,
		&i.ExpiresAt,
	)
	return i, err
}

const deleteConsoleSession = `-- name: DeleteConsoleSession :exec
DELETE FROM console_sessions
WHERE session_id = $1
`

func (q *Queries) DeleteConsoleSession(ctx context.Context, sessionID string) error {
	_, err := q.db.Exec(ctx, deleteConsoleSession, sessionID)
	return err
}

const getConsoleSession = `-- name: GetConsoleSession :one
SELECT session_id, organization_id, created_at, expires_at FROM console_sessions
WHERE session_id = $1
AND expires_at > NOW()
`

func (q *Queries) GetConsoleSession(ctx context.Context, sessionID string) (ConsoleSession, error) {
	row := q.db.QueryRow(ctx, getConsoleSession, sessionID)
	var i ConsoleSession
	err := row.Scan(
		&i.SessionID,
		&i.OrganizationID,
		&i.CreatedAt,
		&i.ExpiresAt,
	)
	return i, err
}
