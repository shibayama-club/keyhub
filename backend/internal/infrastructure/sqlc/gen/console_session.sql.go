// Code generated by sqlc. DO NOT EDIT.
// versions:
//   sqlc v1.30.0
// source: console_session.sql

package gen

import (
	"context"

	"github.com/google/uuid"
)

const cleanupExpiredConsoleSessions = `-- name: CleanupExpiredConsoleSessions :exec
DELETE FROM console_sessions
WHERE expires_at < NOW()
`

func (q *Queries) CleanupExpiredConsoleSessions(ctx context.Context) error {
	_, err := q.db.Exec(ctx, cleanupExpiredConsoleSessions)
	return err
}

const createConsoleSession = `-- name: CreateConsoleSession :one
INSERT INTO console_sessions (
    session_id,
    organization_id,
    created_at,
    expires_at
) VALUES (
    $1, $2, NOW(), NOW() + INTERVAL '24 hours'
) RETURNING console_sessions.session_id, console_sessions.organization_id, console_sessions.created_at, console_sessions.expires_at
`

type CreateConsoleSessionParams struct {
	SessionID      string
	OrganizationID uuid.UUID
}

type CreateConsoleSessionRow struct {
	ConsoleSession ConsoleSession
}

func (q *Queries) CreateConsoleSession(ctx context.Context, arg CreateConsoleSessionParams) (CreateConsoleSessionRow, error) {
	row := q.db.QueryRow(ctx, createConsoleSession, arg.SessionID, arg.OrganizationID)
	var i CreateConsoleSessionRow
	err := row.Scan(
		&i.ConsoleSession.SessionID,
		&i.ConsoleSession.OrganizationID,
		&i.ConsoleSession.CreatedAt,
		&i.ConsoleSession.ExpiresAt,
	)
	return i, err
}

const deleteConsoleSession = `-- name: DeleteConsoleSession :exec
DELETE FROM console_sessions
WHERE session_id = $1
`

func (q *Queries) DeleteConsoleSession(ctx context.Context, sessionID string) error {
	_, err := q.db.Exec(ctx, deleteConsoleSession, sessionID)
	return err
}

const getConsoleSession = `-- name: GetConsoleSession :one
SELECT cs.session_id, cs.organization_id, cs.created_at, cs.expires_at
FROM console_sessions cs
WHERE cs.session_id = $1
AND cs.expires_at > NOW()
`

type GetConsoleSessionRow struct {
	ConsoleSession ConsoleSession
}

func (q *Queries) GetConsoleSession(ctx context.Context, sessionID string) (GetConsoleSessionRow, error) {
	row := q.db.QueryRow(ctx, getConsoleSession, sessionID)
	var i GetConsoleSessionRow
	err := row.Scan(
		&i.ConsoleSession.SessionID,
		&i.ConsoleSession.OrganizationID,
		&i.ConsoleSession.CreatedAt,
		&i.ConsoleSession.ExpiresAt,
	)
	return i, err
}
